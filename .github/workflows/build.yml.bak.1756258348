name: Flutter APK CI
on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          persist-credentials: false
      - uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 21
      - uses: subosito/flutter-action@v2
        with:
          channel: beta
      - uses: actions/cache@v4
        with:
          path: ~/.pub-cache
          key: pubcache-v2-${{ runner.os }}-${{ hashFiles('**/pubspec.yaml') }}
      - name: Upgrade Flutter packages
        run: flutter pub upgrade --major-versions
      - name: Flutter pub get
        run: flutter pub get
      - name: Build DEBUG APK
        run: flutter build apk --debug --no-tree-shake-icons
